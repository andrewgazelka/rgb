[workspace]
members = [
    "app", "markdown", "plugins/x", "plugins/base", "plugins/search", "libs/code-tokenizer", "libs/superglide-paths", "libs/nushell-engine", "mcp-nushell"
]
resolver = "3"

[workspace.package]
authors = ["Andrew Gazelka <andrew.gazelka@gmail.com>"]
categories = []
description = "Superglide - AI-powered assistant for developers"
documentation = "https://github.com/andrewgazelka/superglide-monorepo"
edition = "2024"
exclude = ["assets/*", ".github"]
homepage = "https://github.com/andrewgazelka/superglide-monorepo"
keywords = []
license = "PROPRIETARY"
publish = false
readme = "README.md"
repository = "https://github.com/andrewgazelka/superglide-monorepo"
rust-version = "1.91.0"
version = "0.1.0"

[workspace.dependencies]
# Flecs ECS
flecs_ecs = { git = "https://github.com/Indra-db/Flecs-Rust", features = ["flecs_rest", "flecs_stats", "flecs_meta"] }

# Time
chrono = { version = "0.4", default-features = false, features = ["serde", "clock", "std"] }

# Async
futures-util = "0.3"


strsim = "0.11"
typetag = "0.2"

similar = "2.7"
ignore = "0.4"

code-tokenizer = { path = "libs/code-tokenizer"}

# Nushell
nu-path = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
nu-cli = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
nu-cmd-base = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
nu-cmd-extra = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
nu-cmd-lang = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
nu-cmd-plugin = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
nu-command = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv", default-features = false, features = ["os"] }
nu-engine = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
nu-parser = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
nu-protocol = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
nu-plugin-test-support = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
tempfile = "3.14.0"
nu-plugin = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
nu-plugin-engine = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
nuon = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
snuon = { git = "https://github.com/andrewgazelka/nushell", branch = "claude/fork-nuon-to-snuon-011CV5aP9NgE2BvBrXFP51Wv" }
fancy-regex = "0.14"

libpkgx = "0.7.0"

rusqlite = "0.33"

# File watching
notify = { version = "7.0", default-features = false, features = ["macos_kqueue"] }

# Error handling (plugins)
snafu = "0.8"

# Paths (plugins)
superglide-paths = { path = "libs/superglide-paths" }
home = "0.5"

# Search indexing (plugins)
tantivy = "0.22"
strip-ansi-escapes = "0.2"

# Concurrency
parking_lot = "0.12"

# HTTP & AI
async-openai = "0.31.0-alpha.6"
reqwest = { version = "0.12", default-features = false, features = ["json", "native-tls"] }

# Serialization
serde = { version = "1.0", features = ["derive", "rc"] }
serde_json = "1.0"

# Async runtime
tokio = { version = "1.47.1", features = ["full"] }

# Logging & Tracing
tracing = { version = "0.1" }
tracing-appender = "0.2"
tracing-subscriber = { version = "0.3", features = ["env-filter", "json"] }

# Error handling
color-eyre = "0.6"
eyre = "0.6"

# TUI
crossterm = "0.29"
ratatui = { git = "https://github.com/ratatui/ratatui", branch = "main" }
unicode-width = ">=0.2.1"

# Utilities
fastrand = "2.3.0"

[workspace.lints.clippy]
# Deny all categories
complexity = { level = "deny", priority = -1 }
correctness = { level = "deny", priority = -1 }
nursery = { level = "deny", priority = -1 }
pedantic = { level = "deny", priority = -1 }
perf = { level = "deny", priority = -1 }
style = { level = "deny", priority = -1 }
suspicious = { level = "deny", priority = -1 }

cast_possible_truncation = "allow"
cast_possible_wrap = "allow"
cast_precision_loss = "allow"
cast_sign_loss = "allow"

# Allow specific lints - Code style
collapsible_if = "allow"
doc_lazy_continuation = "allow"
doc_markdown = "allow"
many_single_char_names = "allow"
match_same_arms = "allow"
single_match_else = "allow"
uninlined_format_args = "deny"

# Allow specific lints - Documentation
missing_const_for_fn = "allow"
missing_docs_in_private_items = "allow"
missing_errors_doc = "allow"

# Allow specific lints - Design patterns
future_not_send = "allow"
must_use_candidate = "allow"
needless_pass_by_value = "allow"
option_if_let_else = "allow"
significant_drop_tightening = "allow"
struct_excessive_bools = "allow"

# Allow specific lints - Miscellaneous
multiple_crate_versions = "allow"
similar_names = "allow"

# Deny specific lints - Safety
char_indices_as_byte_indices = "deny"
indexing_slicing = "deny"
string_slice = "deny"

# Deny specific lints - Code quality
allow_attributes = "deny"
allow_attributes_without_reason = "deny"
cognitive_complexity = "deny"
excessive_nesting = "deny"
missing_panics_doc = "deny"
print_stdout = "deny"

[workspace.lints.rust]
# Allow specific lints
dead_code = "allow"
mismatched_lifetime_syntaxes = "allow"

# Deny categories
deprecated_safe = { level = "deny", priority = -1 }
future_incompatible = { level = "deny", priority = -1 }
keyword_idents = { level = "deny", priority = -1 }
rust_2018_idioms = { level = "deny", priority = -1 }

# Warn
unsafe_code = "warn"

# Config
unexpected_cfgs = { level = "warn", check-cfg = ['cfg(feature, values("cargo-clippy"))'] }

[patch.crates-io]
reedline = { git = "https://github.com/nushell/reedline", rev = "68084cde80e366fa5787079064bb65b710f23a97" }
nu-ansi-term = {git = "https://github.com/nushell/nu-ansi-term.git", branch = "main"}

[profile.release-full]
inherits = "release"
codegen-units = 1
debug = false
debug-assertions = false
incremental = false
lto = "fat"
opt-level = "z"
panic = "abort"
rpath = false
strip = true
